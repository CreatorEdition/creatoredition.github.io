<!DOCTYPE html>
<title>通信大数据行程卡</title>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<meta name="viewport" content="width=device-width,height=device-height,viewport-fit=cover,initial-scale=1,maximum-scale=1,user-scalable=0">
<meta name="theme-color" content="#FFFFFF">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<link rel="manifest" href="manifest.json">
<link rel="icon" type="image/png" href="./static/img_arrow@2x.png">
<link rel="apple-touch-icon" sizes="360x360" href="./static/img_arrow@2x.png">
<link rel="stylesheet" href="app.css">
<link rel="stylesheet" href="../common/nav.css">
<script src="../common/base.js"></script>
<script src="https://cdnjs.gtimg.com/cdnjs/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="./static/swiper.min.js"></script>
<body class="login-wrap">

<view class="navbar navbar--wechat">
  <view class="navbar__placeholder"></view>
  <view class="navbar__inner" style="color: black; background: white;">
    <view class="navbar__left">
      <view class="navbar__buttons" onclick="history.back();">
        <view class="navbar__button-goback"></view>
      </view>
    </view>
    <view class="navbar__center">
      <span>通信行程卡</span>
    </view>
    <view class="navbar__right">
      <div class="capsule capsule--wechat" onclick="navigateHome();">
        <svg class="capsule__menu-icon" viewBox="0 0 64 28" xmlns="http://www.w3.org/2000/svg">
          <circle cx="32" cy="14" r="9.5"/>
          <circle cx="54" cy="14" r="6"/>
          <circle cx="10" cy="14" r="6"/>
        </svg>
        <div class="capsule__splitter"></div>
        <svg class="capsule__exit-icon" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg">
          <circle cx="30" cy="30" r="9"/>
          <circle cx="30" cy="30" r="23" stroke-width="6" fill="transparent"/>
        </svg>
      </div>
    </view>
  </view>
</view>

<!-- Still On TEST --
<view class="navbar navbar--wechat">
  <view class="navbar__placeholder"></view>
  <view class="navbar__inner quickpop" style="color: black; background: white;">
    <view class="navbar__left">
      <img class="icon" src="./static/img_arrow@2x.png">
      <span>通信行程卡 提供服务 ></span>
    </view>
    <view class="navbar__right">
      <div class="capsule capsule--wechat" onclick="navigateHome();">
        <svg class="capsule__exit-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
        </svg>
      </div>
    </view>
  </view>
</view>
-->
<view>
  <image class="home" mode="widthFix" src="./static/title1.png"></image>
  <div class="login_box">
    <div class="phone_box">
      <div class="phone_icon">
        <img src="./static/ico_phone@2x.png" alt="">
      </div>
      <div class="phone_input">
          <input type="tel" maxlength="11" placeholder="手机号">
      </div>
      <div class="send_msg">
        <div class="send_msg_button phonebtn phonebtn-s">获取验证码</div>
      </div>
    </div>
    <div class="code_box">
      <div class="code_icon">
        <img src="./static/ico_lock@2x.png" alt="">
      </div>
      <div class="code_input">
        <label>
          <input type="tel" maxlength="6" placeholder="请输入验证码">
        </label>
      </div>
    </div>
    <div class="protocol_box">
      <div class="radio_input">
        <div class="protocol_radio radio_un_click" data-bind="select_button"></div>
      </div>
      <div class="protocol_text">
        同意并授权运营商查询本人在疫情期间7天内到访地信息
      </div>
    </div>
    <div class="select_button button_un_click">查询</div>
    <div class="illustrate_button">行程卡使用说明</div>
  </div>
  <div class="foot">
    <div class="external_link">
      <div class="external_link_title">
        <div class="thread"><div></div></div>
        <div class="title_name">本服务联合提供</div>
        <div class="thread"><div></div></div>
      </div>
      <div class="external_link_body"></div>
    </div>
    <div class="service_line">
      客服热线：<label><a href="">10000</a> / <a href="">10086</a> / <a href="">10010</a> / <a href="">10099</a></label>
    </div>

    <div class="banner">
      <div class="swiper-container">
        <div class="swiper-wrapper">
          <div class="swiper-slide"><img src="./static/banner_1.png" alt=""></div>
          <div class="swiper-slide"><img src="./static/banner_2.png" alt=""></div>
          <div class="swiper-slide"><img src="./static/banner_3.png" alt=""></div>
          <div class="swiper-slide"><img src="./static/banner_4.png" alt=""></div>
          <div class="swiper-slide"><img src="./static/banner_5.png" alt=""></div>
        </div>
        <!-- Add Pagination -->
        <div class="swiper-pagination"></div>
      </div>
    </div>
  </div>

  <div class="qd-dialog">
    <div class="qd-dialog--mask"></div>
    <div class="qd-dialog--container" style="">
      <div class="popup_windows">
        <div class="qd_close">
          <img src="./static/ico_close@3x.png">
        </div>
        <div class="popup_dialog_title">
          <img src="./static/img_cards@3x.png" class="qdimg">
        </div>

        <div class="popup_title">当前查询内容</div>
        <div class="phone_number" name="phone_number"><span id="phone"></span></div>
        <div class="protocol_box">
          <div class="radio_input">
            <div class="protocol_radio radio_un_click" data-bind="select_button"></div>
          </div>
          <div class="protocol_text">
            同意并授权运营商查询本人在疫情期间7天内到访地信息
          </div>
        </div>
        <div class="select_button button_un_click">查询</div>
      </div>
    </div>
  </div>

</view>
<script>

  console.log('code',getRandomSixDigit())
  addStorageField("_phone", "#phone", "手机号码", "13"+getRandomSixDigit(), presetFilters.phone());
</script>
<script>
  const $sendCodeBtn = $(".phonebtn");
  const $submitBtn = $(".select_button");
  const $submitRadio = $(".protocol_radio");
  const $phoneInput = $(".phone_input input");

  $(".qd_close").click(function (){
    popup_hide()
  });
  $(".protocol_box").click(function (){
    if($(".protocol_box > .radio_input > .protocol_radio").hasClass("radio_un_click")){
      radio_check();
    }else{
      radio_uncheck();
    }
  });

  /*** Phone Number Input ***/
  $phoneInput.on("input", (e) => {
    if (e.currentTarget.value.length >= 11) {
      $sendCodeBtn.removeClass("phonebtn-s");
      $sendCodeBtn.prop("disabled", false);
    } else {
      $sendCodeBtn.addClass("phonebtn-s");
      $sendCodeBtn.prop("disabled", true);
    }
  });

  /*** Send SMS Code Btn ***/
  $sendCodeBtn.click(async () => {
    $sendCodeBtn.prop("disabled", true);
    $sendCodeBtn.addClass("phonebtn-s");
    for (let i = 60; i >= 0; --i) {
      $sendCodeBtn.text(i + "s后重试");
      await sleep(1000);
    }
    $sendCodeBtn.prop("disabled", false);
    $sendCodeBtn.removeClass("phonebtn-s");
    $sendCodeBtn.text("获取验证码");
  });
  $submitBtn.click(async () => {
    $submitBtn.text("确认中");
    await sleep(800);
    window.location.href = "result.html";
    /* const addr = new URLSearchParams(window.location.search).get("addr") || returnCitySN.cname;
    const queryString = new URLSearchParams();
    const phone = $phoneInput.val();
    queryString.set("phone", phone.substring(0, 3) + '****' + phone.substring(7));
    queryString.set("addr", addr);
    window.location.href = "result.html?" + queryString.toString();
    */
  });
</script>
<script>
  var swiper = new Swiper('.swiper-container', {
    pagination: {
      el: '.swiper-pagination',
    },
    paginationClickable: true,
    autoplay: {
      delay: 3000,
      disableOnInteraction:false,
    },

    loop: true,
  });
  function radio_check(){
    $submitRadio.removeClass("radio_un_click");
    $submitRadio.addClass("radio_click");
    $submitBtn.removeClass("button_un_click");
    $submitBtn.addClass("button_click");
  }
  function radio_uncheck(){
    $submitRadio.removeClass("radio_click");
    $submitRadio.addClass("radio_un_click");
    $submitBtn.removeClass("button_click");
    $submitBtn.addClass("button_un_click");
  }
  function popup_show(){
    $(window.parent)[0].loading_show();
    setTimeout(function (){
      $(".qd-dialog").fadeIn(300);
      $("body").css("overflow","hidden");
      $(window.parent)[0].loading_hide();
    },150)
  }
  function popup_hide(){
    $(".qd-dialog").hide();
    $("body").css("overflow","");
  }
</script>
</body>